<!DOCTYPE html>
<html>
<head>
    <title>PNG LSB Decoder</title>
</head>
<body>
<h1>PNG LSB Steganography Decoder</h1>
<input type="file" id="fileInput" accept=".png">
<div id="result"></div>


<script>
    window.onload = function() {
        // PNG LSB Steganography Decoder in JavaScript
        async function decryptPNG(src) {
            // Load the image
            const img = await loadImage(src);

            // Create canvas to work with pixel data
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);

            // Get image data
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;

            let binaryMessage = '';
            let x = 0;

            while (true) {
                const y = x; // Use diagonal pixels (x, x)

                // Check bounds
                if (x >= canvas.width || y >= canvas.height) break;

                // Get pixel index (RGBA format)
                const idx = (y * canvas.width + x) * 4;

                // Get blue channel (index 2 in RGBA)
                const blue = data[idx + 2];
                // console.log(data,blue)

                // Get LSB (least significant bit)
                const lsb = blue & 1;
                binaryMessage += lsb.toString();
                console.log(binaryMessage)
                // Check for termination (8 zero bits)
                if (binaryMessage.length >= 8) {
                    const last8 = binaryMessage.slice(-8);
                    if (last8 === '00000000') {
                        break;
                    }
                }

                x++;
            }

            // Remove the termination sequence
            binaryMessage = binaryMessage.slice(0, -8);

            // Convert binary to text
            return binaryToText(binaryMessage);
        }

// Helper function to load an image
        function loadImage(src) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => resolve(img);
                img.onerror = reject;
                img.src = src;
            });
        }

// Convert binary string to text
        function binaryToText(binary) {
            let text = '';
            for (let i = 0; i < binary.length; i += 8) {
                const byte = binary.slice(i, i + 8);
                if (byte.length < 8) break;
                text += String.fromCharCode(parseInt(byte, 2));
            }
            return text;
        }

// Usage example
        document.getElementById('fileInput').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = async function(event) {
                const hiddenMessage = await decryptPNG(event.target.result);
                document.getElementById('result').textContent = `Hidden message: ${hiddenMessage}`;
            };
            reader.readAsDataURL(file);
        });
    }
</script>
</body>

</html>